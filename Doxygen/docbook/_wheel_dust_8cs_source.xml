<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__wheel_dust_8cs_source">
<title>WheelDust.cs</title>
<indexterm><primary>O:/GitHUBMINIPRoject/Assets/SteamVR/InteractionSystem/Samples/BuggyBuddy/WheelDust.cs</primary></indexterm>
<programlisting>00001 <emphasis role="keyword">using</emphasis>&#32;System.Collections;
00002 <emphasis role="keyword">using</emphasis>&#32;System.Collections.Generic;
00003 <emphasis role="keyword">using</emphasis>&#32;<link linkend="__balloon_8cs_1a7d67e097df9376eb709b6a23aa3c7d23">UnityEngine</link>;
00004 
00005 <emphasis role="keyword">namespace&#32;</emphasis><link linkend="_namespace_valve_1_1_v_r_1_1_interaction_system_1_1_sample">Valve.VR.InteractionSystem.Sample</link>
00006 {
<anchor xml:id="__wheel_dust_8cs_source_1l00007"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust">00007</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keyword">class&#32;</emphasis><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust">WheelDust</link>&#32;:&#32;MonoBehaviour
00008 &#32;&#32;&#32;&#32;{
00009 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">private</emphasis>&#32;WheelCollider&#32;col;
00010 
<anchor xml:id="__wheel_dust_8cs_source_1l00011"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ab27fcdebaf5da4d81be04844e4b47226">00011</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;ParticleSystem&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ab27fcdebaf5da4d81be04844e4b47226">p</link>;
00012 
<anchor xml:id="__wheel_dust_8cs_source_1l00013"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ad3d83ad88b6e90397b07c6ce76ca5f0d">00013</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ad3d83ad88b6e90397b07c6ce76ca5f0d">EmissionMul</link>;
00014 
<anchor xml:id="__wheel_dust_8cs_source_1l00015"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a548fed4a360281ab52ded66d85e26149">00015</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a548fed4a360281ab52ded66d85e26149">velocityMul</link>&#32;=&#32;2;
00016 
<anchor xml:id="__wheel_dust_8cs_source_1l00017"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6857abfe90991780af193ca6690391a3">00017</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6857abfe90991780af193ca6690391a3">maxEmission</link>;
00018 
<anchor xml:id="__wheel_dust_8cs_source_1l00019"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a01d22edd5fb3b290064c3716ce1e3127">00019</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a01d22edd5fb3b290064c3716ce1e3127">minSlip</link>;
00020 
00021 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[HideInInspector]
<anchor xml:id="__wheel_dust_8cs_source_1l00022"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a83fecc9173f8d35450f8d409be27126c">00022</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a83fecc9173f8d35450f8d409be27126c">amt</link>;
00023 
00024 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[HideInInspector]
<anchor xml:id="__wheel_dust_8cs_source_1l00025"/><link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6e0e15471f7cf36098568d1763519662">00025</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;Vector3&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6e0e15471f7cf36098568d1763519662">slip</link>;
00026 
00027 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">private</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;emitTimer;
00028 
00029 
00030 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">private</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;Start()
00031 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00032 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;col&#32;=&#32;GetComponent&lt;WheelCollider&gt;();
00033 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;StartCoroutine(emitter());
00034 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00035 
00036 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">private</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;Update()
00037 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00038 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6e0e15471f7cf36098568d1763519662">slip</link>&#32;=&#32;Vector3.zero;
00039 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(col.isGrounded)
00040 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00041 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;WheelHit&#32;hit;
00042 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;col.GetGroundHit(out&#32;hit);
00043 
00044 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6e0e15471f7cf36098568d1763519662">slip</link>&#32;+=&#32;Vector3.right&#32;*&#32;hit.sidewaysSlip;
00045 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6e0e15471f7cf36098568d1763519662">slip</link>&#32;+=&#32;Vector3.forward&#32;*&#32;-hit.forwardSlip;
00046 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//print(slip);</emphasis>
00047 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00048 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a83fecc9173f8d35450f8d409be27126c">amt</link>&#32;=&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6e0e15471f7cf36098568d1763519662">slip</link>.magnitude;
00049 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//print(amt);</emphasis>
00050 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00051 
00052 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">private</emphasis>&#32;IEnumerator&#32;emitter()
00053 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00054 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(<emphasis role="keyword">true</emphasis>)
00055 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00056 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(emitTimer&#32;&lt;&#32;1)
00057 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00058 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;yield&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">null</emphasis>;
00059 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a83fecc9173f8d35450f8d409be27126c">amt</link>&#32;&gt;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a01d22edd5fb3b290064c3716ce1e3127">minSlip</link>)
00060 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00061 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;emitTimer&#32;+=&#32;Mathf.Clamp((<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ad3d83ad88b6e90397b07c6ce76ca5f0d">EmissionMul</link>&#32;*&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a83fecc9173f8d35450f8d409be27126c">amt</link>),&#32;0.01f,&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6857abfe90991780af193ca6690391a3">maxEmission</link>);
00062 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00063 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00064 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;emitTimer&#32;=&#32;0;
00065 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;DoEmit();
00066 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00068 
00069 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">private</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;DoEmit()
00070 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
00071 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ab27fcdebaf5da4d81be04844e4b47226">p</link>.transform.rotation&#32;=&#32;Quaternion.LookRotation(transform.TransformDirection(<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a6e0e15471f7cf36098568d1763519662">slip</link>));
00072 
00073 <emphasis role="preprocessor">#if&#32;UNITY_2017_1_OR_NEWER</emphasis>
00074 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ParticleSystem.MainModule&#32;mainModule&#32;=&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ab27fcdebaf5da4d81be04844e4b47226">p</link>.main;
00075 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mainModule.startSpeed&#32;=&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a548fed4a360281ab52ded66d85e26149">velocityMul</link>&#32;*&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a83fecc9173f8d35450f8d409be27126c">amt</link>;
00076 <emphasis role="preprocessor">#else</emphasis>
00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ab27fcdebaf5da4d81be04844e4b47226">p</link>.startSpeed&#32;=&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a548fed4a360281ab52ded66d85e26149">velocityMul</link>&#32;*&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1a83fecc9173f8d35450f8d409be27126c">amt</link>;
00078 <emphasis role="preprocessor">#endif</emphasis>
00079 
00080 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_valve_1_1_v_r_1_1_interaction_system_1_1_sample_1_1_wheel_dust_1ab27fcdebaf5da4d81be04844e4b47226">p</link>.Emit(1);
00081 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
00082 &#32;&#32;&#32;&#32;}
00083 }
</programlisting></section>
